# Python env   : Python 3.12.0 ()
# -*- coding: utf-8 -*-        
# @Time    : 2025/9/20 上午10:26   
# @Author  : 李清水            
# @File    : mpy_toolchain.py       
# @Description : 一个单文件脚本：
# 1) 扫描指定根目录下的所有 .py 文件（递归），并建立“文件依赖关系图”（尽力解析 import / from ... import ...，支持常见的绝对/相对/点分导入）
# 2) 根据依赖关系进行拓扑排序（检测循环依赖并提示）
# 3) 按顺序使用外部工具 mpy-cross 编译为 .mpy（避免因同名不同路径覆盖，通过相对路径映射生成唯一输出名）
# 4) 使用 mpremote 批量将生成的 .mpy 上传到目标设备（或多个设备），支持 dry-run、并行上传等常用选项
# 说明：脚本做了“尽力而为”的依赖解析——能覆盖绝大多数常见 Python 导入写法，但并非完整 Python 解释器级别的解析器。


